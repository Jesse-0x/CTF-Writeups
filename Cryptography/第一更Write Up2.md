# 第一更Write Up

##### ～☆这次题目考查的是对于RSA 当p-1为Smooth number(平滑数)的大数Factorization(因式分解)的掌握☆～

原题目：
```
n = 4bb5317214aa3607c1d6bf1868a71ec878194668c2c998e44193be44765fd588e0978ca23309d0edabb2ee9cd815f7d759abc0a9b13427e6081a565ed1818a16a9aa8b90a6f015bf994e5311f4a79bee90aacc94ef74b8b52c1376c5e57c66faeb4bfab99c6222338bd0483aa93614b0285584af051b0adc42377a49bc817ba0
c = 6daf9b64da3b3fb8b09fa0b93e84938227be26e5c0e4f7740d1323a435183cb8e5add670c0e8c60e268a604093b92a0aa2335aa7a59a6a995215601bad43558a8fb647d9ea24f95d6c67ba7112c7ac6e946e2b9c62440f1e437713afcd46f93d8253837608a545c92435067f999f5f79c8be08177d5b6ff55304101c8a333174

hint: I like ice, because I can skating on it smoothly~
PS: Even though I don't know how to skatting...
```

考察的知识点：主要方式为Pollard's *p* − 1 algorithm(当然其他方式也可以)

#### Pollard's *p* − 1 algorithm：

基本背景：为Pollard大大在提出Pollard P algorithm后1974年提出的另一个算法。

算法本身依赖于Fermat's little theorem(费马小定律)。

##### 费马小定律:

假设有一个数字：N，为 p 和 q 的乘积，且 p 与 q为互质数（gcd(p, q) = 1)。设a为一个与 p 互质的数字（gcd(a, p) = 1），那么```a^(p-1)≡1（mod p)``` 或者可以写为```a^(p-1) % p = 1 % p ``` ```a^(p-1) % p = 1 ```

##### 回到Pollard's *p* − 1 algorithm：

根据这一定理，对于任意整数 k，有```a^(k(p-1)) ≡ 1^k ≡ 1(mod p)```。 。因此对于 p-1的任意倍数M，有```a^M ≡ 1(mod p)```及p整除 a^M - 1， 又p整除N，因此：

```a^M ≡ 1 (mod p) ``` OR ```a^M % p = 1 ```

及p整除a^M - 1， 又p整除N，因此 ```gcd(a^M - 1, N) = p```

##### 构建倍数M：

可以指定一个上限B，然后将小雨B的质数和/或质数的幂乘起来得到M。

##### 复杂程度：

对于上界B，执行一次的时间复杂度为```O(B × log B × log^2 N)```。 P - 1是否能找到取决于N的因子 p-1是否是smooth number（及可被拆分为由较小的质数相乘的得到的数字）；最坏情况为（p-1)/2是一个质数，这样P - 1就不优与其他方法。

#### 举个栗子：

N = 299，取B = 5。这样的话M = 2^2 * 3^1 * 5^1 = 60。取a为2， gcd(a^M-1. N)就为13。

### 题目：

上限其实可以设为10^6左右（也许可以更小？懒得实验了）A可以爆破为233503，此时，P为```11970643845127009001513231211498174335243437158373975358470747372125526833110648758992997943788020208274949401766663064520118479980429575384361108252378343```， Q为```9591612684261540601649913336764688061059337893157114169923217191744641344149058377628714620103398146178725643220488981773484794653620946816817804726276863```。

### FLAG:

||flag{RSA_4nd_LSB_1snt_th1s_fun_B6D37A}||
